/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={58394:function(e,t,n){"use strict";e.exports=n.p+"1fda685b81e1123773f6.css"},60947:function(e,t,n){"use strict";e.exports=n.p+"f06b13ca417cd37aa147.js"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(t){if(null!=t){var n=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}throw new TypeError(e(t)+" is not iterable")}function n(){var e,t,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function u(n,o,i,a){var u=o&&o.prototype instanceof f?o:f,s=Object.create(u.prototype);return r(s,"_invoke",function(n,r,o){var i,a,u,f=0,s=o||[],l=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return i=t,a=0,u=e,p.n=n,c}};function d(n,r){for(a=n,u=r,t=0;!l&&f&&!o&&t<s.length;t++){var o,i=s[t],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=e):i[0]<=d&&((o=n<2&&d<i[1])?(a=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,a=0))}if(o||n>1)return c;throw l=!0,r}return function(o,s,y){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&d(s,y),a=s,u=y;(t=a<2?e:u)||!l;){i||(a?a<3?(a>1&&(p.n=-1),d(a,u)):p.n=u:p.v=u);try{if(f=2,i){if(a||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,a<2&&(a=0)}else 1===a&&(t=i.return)&&t.call(i),a<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=e}else if((t=(l=p.n<0)?u:n.call(r,p))!==c)break}catch(t){i=e,a=1,u=t}finally{f=1}}return{value:t,done:l}}}(n,i,a),!0),s}var c={};function f(){}function s(){}function l(){}t=Object.getPrototypeOf;var p=[][i]?t(t([][i]())):(r(t={},i,function(){return this}),t),d=l.prototype=f.prototype=Object.create(p);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,r(e,a,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=l,r(d,"constructor",l),r(l,"constructor",s),s.displayName="GeneratorFunction",r(l,a,"GeneratorFunction"),r(d),r(d,a,"Generator"),r(d,i,function(){return this}),r(d,"toString",function(){return"[object Generator]"}),(n=function(){return{w:u,m:y}})()}function r(e,t,n,o){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}r=function(e,t,n,o){function a(t,n){r(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},r(e,t,n,o)}function o(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function u(e){o(a,r,i,u,c,"next",e)}function c(e){o(a,r,i,u,c,"throw",e)}u(void 0)})}}var a=null;function u(){return c.apply(this,arguments)}function c(){return c=i(n().m(function e(){var t,r,o,u;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:if(a&&a.files&&0!==a.files.length){e.n=1;break}return console.error("Nessun file selezionato"),alert("Seleziona prima un file CSV"),e.a(2);case 1:return document.getElementById("run").disabled=!0,e.p=2,t=a.files[0],e.n=3,f(t);case 3:return r=e.v,o=l(r),e.n=4,Excel.run(function(){var e=i(n().m(function e(t){var r,i,a,u;return n().w(function(e){for(;;)switch(e.n){case 0:return r=t.workbook.worksheets.getActiveWorksheet(),(i=r.getUsedRange()).load("values"),e.n=1,t.sync();case 1:return a=i.values,a=d(o,a),(u=r.getRangeByIndexes(0,0,a.length,a[0].length)).values=a,e.n=2,y(a,r,t,o);case 2:return u.format.autofitColumns(),u.format.autofitRows(),e.n=3,t.sync();case 3:console.log("Importazione completata con successo!"),alert("Dati aggiornati con successo!");case 4:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 4:e.n=6;break;case 5:e.p=5,u=e.v,console.error("Errore:",u),alert("Errore durante l'importazione: "+u.message);case 6:return e.p=6,document.getElementById("loading").style.display="none",document.getElementById("run").disabled=!1,e.f(6);case 7:return e.a(2)}},e,null,[[2,5,6,7]])})),c.apply(this,arguments)}function f(e){return new Promise(function(t,n){var r=new FileReader;r.onload=function(){return t(r.result)},r.onerror=n,r.readAsArrayBuffer(e)})}function s(e){if(!e||0===e.length)return[];for(var t=-1,n=0;n<e[0].length;n++)if("matricola"===String(e[0][n]).toLowerCase()){t=n;break}if(-1===t)for(var r=0;r<e[0].length;r++){for(var o=new Set,i=!0,a=1;a<e.length;a++){if(o.has(e[a][r])){i=!1;break}o.add(e[a][r])}if(i){t=r;break}}return-1===t?[]:t}function l(e){return(new TextDecoder).decode(e).trim().split(/\r?\n/).map(function(e){var t=function(e){return e.replace(/"(\d+),(\d+)"/g,"$1.$2")}(e),n=t.includes(";")?";":",";return t.split(n).map(p)})}function p(e){if(e=e.trim(),/^\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}$/.test(e))return e;var t=e.toString(),n=Number(t);return isNaN(n)?t:n}function d(e,t){for(var n=s(e),r=s(t),o=e.slice(1).map(function(e){return e[n]}),i=t.slice(1).map(function(e){return e[r]}),a=0;a<o.length;a++){var u=i.indexOf(o[a]);if(-1!==u)for(var c=u+1,f=0;f<t[0].length;f++){var l=e[a+1][f],p=t[0][f];(p.toLowerCase().includes("mese")||p.toLowerCase().includes("data"))&&(t[c][f]=l),f!==r&&("number"==typeof l&&"number"==typeof t[c][f]?t[c][f]+=l:t[c][f]!=l&&(t[c][f]=l))}}return t}function y(e,t,n,r){return m.apply(this,arguments)}function m(){return(m=i(n().m(function e(r,o,i,a){var u,c;return n().w(function(e){for(;;)switch(e.n){case 0:u=n().m(function e(t){var i,u,c,f,s,l,p;return n().w(function(e){for(;;)switch(e.n){case 0:r[0][t].toString().toLowerCase(),i=!1,u=!1,c=1;case 1:if(!(c<r.length)){e.n=4;break}if("number"!=typeof(f=r[c][t])||Number.isInteger(f)){e.n=2;break}u=!0,e.n=3;break;case 2:if("string"!=typeof f||!/^\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}$/.test(f)){e.n=3;break}return i=!0,e.a(3,4);case 3:c++,e.n=1;break;case 4:if(s=o.getRangeByIndexes(1,t,r.length-1,1),u)s.numberFormat=[["#,##0.00;[Red]-#,##0.00"]];else if(i){for(l=a[1][t],p=1;p<r.length;p++)r[p][t]=l;s.values=r.slice(1).map(function(e){return[e[t]]}),s.numberFormat=[["@"]]}case 5:return e.a(2)}},e)}),c=0;case 1:if(!(c<r[0].length)){e.n=3;break}return e.d(t(u(c)),2);case 2:c++,e.n=1;break;case 3:return e.n=4,i.sync();case 4:return e.a(2)}},e)}))).apply(this,arguments)}Office.onReady(function(e){if(e.host===Office.HostType.Excel){document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",a=document.getElementById("fileInput");var t=document.getElementById("run");a.addEventListener("change",function(){a.files&&a.files.length>0&&(console.log("File selezionato:",a.files[0].name),document.getElementById("fileName").textContent="Selected file: "+a.files[0].name)}),t.addEventListener("click",u)}})}(),function(){"use strict";new URL(n(58394),n.b),new URL(n(60947),n.b)}()}();
//# sourceMappingURL=taskpane.js.map