/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={58394:function(e,t,n){"use strict";e.exports=n.p+"1fda685b81e1123773f6.css"},60947:function(e,t,n){"use strict";e.exports=n.p+"6281d9bb62a14459936d.js"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function e(){var n,r,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.toStringTag||"@@toStringTag";function c(e,o,a,i){var c=o&&o.prototype instanceof s?o:s,f=Object.create(c.prototype);return t(f,"_invoke",function(e,t,o){var a,i,c,s=0,f=o||[],l=!1,p={p:0,n:0,v:n,a:d,f:d.bind(n,4),d:function(e,t){return a=e,i=0,c=n,p.n=t,u}};function d(e,t){for(i=e,c=t,r=0;!l&&s&&!o&&r<f.length;r++){var o,a=f[r],d=p.p,g=a[2];e>3?(o=g===t)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=n):a[0]<=d&&((o=e<2&&d<a[1])?(i=0,p.v=t,p.n=a[1]):d<g&&(o=e<3||a[0]>t||t>g)&&(a[4]=e,a[5]=t,p.n=g,i=0))}if(o||e>1)return u;throw l=!0,t}return function(o,f,g){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&d(f,g),i=f,c=g;(r=i<2?n:c)||!l;){a||(i?i<3?(i>1&&(p.n=-1),d(i,c)):p.n=c:p.v=c);try{if(s=2,a){if(i||(o="next"),r=a[o]){if(!(r=r.call(a,c)))throw TypeError("iterator result is not an object");if(!r.done)return r;c=r.value,i<2&&(i=0)}else 1===i&&(r=a.return)&&r.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=n}else if((r=(l=p.n<0)?c:e.call(t,p))!==u)break}catch(e){a=n,i=1,c=e}finally{s=1}}return{value:r,done:l}}}(e,a,i),!0),f}var u={};function s(){}function f(){}function l(){}r=Object.getPrototypeOf;var p=[][a]?r(r([][a]())):(t(r={},a,function(){return this}),r),d=l.prototype=s.prototype=Object.create(p);function g(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,t(e,i,"GeneratorFunction")),e.prototype=Object.create(d),e}return f.prototype=l,t(d,"constructor",l),t(l,"constructor",f),f.displayName="GeneratorFunction",t(l,i,"GeneratorFunction"),t(d),t(d,i,"Generator"),t(d,a,function(){return this}),t(d,"toString",function(){return"[object Generator]"}),(e=function(){return{w:c,m:g}})()}function t(e,n,r,o){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}t=function(e,n,r,o){function i(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?a?a(e,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[n]=r:(i("next",0),i("throw",1),i("return",2))},t(e,n,r,o)}function n(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function r(e){return function(){var t=this,r=arguments;return new Promise(function(o,a){var i=e.apply(t,r);function c(e){n(i,o,a,c,u,"next",e)}function u(e){n(i,o,a,c,u,"throw",e)}c(void 0)})}}var o=null;function a(){return i.apply(this,arguments)}function i(){return i=r(e().m(function t(){var n,a,i,u;return e().w(function(t){for(;;)switch(t.p=t.n){case 0:if(o&&o.files&&0!==o.files.length){t.n=1;break}return console.error("Nessun file selezionato"),alert("Seleziona prima un file CSV"),t.a(2);case 1:return document.getElementById("run").disabled=!0,t.p=2,n=o.files[0],t.n=3,c(n);case 3:return a=t.v,i=s(a),t.n=4,Excel.run(function(){var t=r(e().m(function t(n){var r,o,a,c;return e().w(function(e){for(;;)switch(e.n){case 0:return r=n.workbook.worksheets.getActiveWorksheet(),(o=r.getUsedRange()).load("values"),e.n=1,n.sync();case 1:return a=o.values,a=l(i,a),(c=r.getRangeByIndexes(0,0,a.length,a[0].length)).values=a,e.n=2,p(a,r,n,i);case 2:return c.format.autofitColumns(),c.format.autofitRows(),e.n=3,n.sync();case 3:console.log("Importazione completata con successo!"),alert("Dati aggiornati con successo!");case 4:return e.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}());case 4:t.n=6;break;case 5:t.p=5,u=t.v,console.error("Errore:",u),alert("Errore durante l'importazione: "+u.message);case 6:return t.p=6,document.getElementById("loading").style.display="none",document.getElementById("run").disabled=!1,t.f(6);case 7:return t.a(2)}},t,null,[[2,5,6,7]])})),i.apply(this,arguments)}function c(e){return new Promise(function(t,n){var r=new FileReader;r.onload=function(){return t(r.result)},r.onerror=n,r.readAsArrayBuffer(e)})}function u(e){if(!e||0===e.length)return[];for(var t=-1,n=0;n<e[0].length;n++)if("matricola"===String(e[0][n]).toLowerCase()){t=n;break}if(-1===t)for(var r=0;r<e[0].length;r++){for(var o=new Set,a=!0,i=1;i<e.length;i++){if(o.has(e[i][r])){a=!1;break}o.add(e[i][r])}if(a){t=r;break}}return-1===t?[]:t}function s(e){return(new TextDecoder).decode(e).trim().split(/\r?\n/).map(function(e){var t=function(e){return e.replace(/"(\d+),(\d+)"/g,"$1.$2")}(e),n=t.includes(";")?";":",";return t.split(n).map(f)})}function f(e){if(e=e.trim(),/^\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}$/.test(e))return e;var t=e.toString(),n=Number(t);return isNaN(n)?t:n}function l(e,t){for(var n=u(e),r=u(t),o=e.slice(1).map(function(e){return e[n]}),a=t.slice(1).map(function(e){return e[r]}),i=0;i<o.length;i++){var c=a.indexOf(o[i]);if(-1!==c)for(var s=c+1,f=0;f<t[0].length;f++){var l=e[i+1][f],p=t[0][f];(p.toLowerCase().includes("mese")||p.toLowerCase().includes("data"))&&(t[s][f]=l),f!==r&&("number"==typeof l&&"number"==typeof t[s][f]?t[s][f]+=l:t[s][f]!=l&&(t[s][f]=l))}}return t}function p(e,t,n,r){return d.apply(this,arguments)}function d(){return(d=r(e().m(function t(n,r,o,a){var i,c,s,f,l,p,d,g,m,b,y,h,v,w,k;return e().w(function(e){for(;;)switch(e.n){case 0:i=0;case 1:if(!(i<n[0].length)){e.n=12;break}c=n[0][i].toString().toLowerCase(),s=!1,f=!1,l=1;case 2:if(!(l<n.length)){e.n=5;break}if("number"!=typeof(p=n[l][i])||Number.isInteger(p)){e.n=3;break}f=!0,e.n=4;break;case 3:if("string"!=typeof p||!c.includes("mese")&&!c.includes("data")){e.n=4;break}return s=!0,e.a(3,5);case 4:l++,e.n=2;break;case 5:if(d=r.getRangeByIndexes(1,i,n.length-1,1),!f){e.n=6;break}d.numberFormat=[["#,##0.00;[Red]-#,##0.00"]],e.n=11;break;case 6:if(!s){e.n=11;break}u(a),g=a[0],m=-1,b=0;case 7:if(!(b<g.length)){e.n=9;break}if(!(y=g[b].toString().toLowerCase()).includes("data")&&!y.includes("mese")){e.n=8;break}return m=b,e.a(3,9);case 8:b++,e.n=7;break;case 9:if(-1!==m){e.n=10;break}return e.a(2);case 10:for(h=a[1][m],v=r.getRangeByIndexes(1,i,n.length-1,1),w=[],k=1;k<n.length;k++)w.push([h]);v.values=w,v.numberFormat=[["@"]];case 11:i++,e.n=1;break;case 12:return e.n=13,o.sync();case 13:return e.a(2)}},t)}))).apply(this,arguments)}Office.onReady(function(e){if(e.host===Office.HostType.Excel){document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",o=document.getElementById("fileInput");var t=document.getElementById("run");o.addEventListener("change",function(){o.files&&o.files.length>0&&(console.log("File selezionato:",o.files[0].name),document.getElementById("fileName").textContent="Selected file: "+o.files[0].name)}),t.addEventListener("click",a)}})}(),function(){"use strict";new URL(n(58394),n.b),new URL(n(60947),n.b)}()}();
//# sourceMappingURL=taskpane.js.map