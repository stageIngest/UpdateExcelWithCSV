/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={58394:function(e,t,n){"use strict";e.exports=n.p+"1fda685b81e1123773f6.css"},60947:function(e,t,n){"use strict";e.exports=n.p+"85b4ed18e7a7dfd610f4.js"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function e(){var n,r,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function u(e,o,i,a){var u=o&&o.prototype instanceof s?o:s,f=Object.create(u.prototype);return t(f,"_invoke",function(e,t,o){var i,a,u,s=0,f=o||[],l=!1,p={p:0,n:0,v:n,a:d,f:d.bind(n,4),d:function(e,t){return i=e,a=0,u=n,p.n=t,c}};function d(e,t){for(a=e,u=t,r=0;!l&&s&&!o&&r<f.length;r++){var o,i=f[r],d=p.p,m=i[2];e>3?(o=m===t)&&(u=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=n):i[0]<=d&&((o=e<2&&d<i[1])?(a=0,p.v=t,p.n=i[1]):d<m&&(o=e<3||i[0]>t||t>m)&&(i[4]=e,i[5]=t,p.n=m,a=0))}if(o||e>1)return c;throw l=!0,t}return function(o,f,m){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&d(f,m),a=f,u=m;(r=a<2?n:u)||!l;){i||(a?a<3?(a>1&&(p.n=-1),d(a,u)):p.n=u:p.v=u);try{if(s=2,i){if(a||(o="next"),r=i[o]){if(!(r=r.call(i,u)))throw TypeError("iterator result is not an object");if(!r.done)return r;u=r.value,a<2&&(a=0)}else 1===a&&(r=i.return)&&r.call(i),a<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=n}else if((r=(l=p.n<0)?u:e.call(t,p))!==c)break}catch(e){i=n,a=1,u=e}finally{s=1}}return{value:r,done:l}}}(e,i,a),!0),f}var c={};function s(){}function f(){}function l(){}r=Object.getPrototypeOf;var p=[][i]?r(r([][i]())):(t(r={},i,function(){return this}),r),d=l.prototype=s.prototype=Object.create(p);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,t(e,a,"GeneratorFunction")),e.prototype=Object.create(d),e}return f.prototype=l,t(d,"constructor",l),t(l,"constructor",f),f.displayName="GeneratorFunction",t(l,a,"GeneratorFunction"),t(d),t(d,a,"Generator"),t(d,i,function(){return this}),t(d,"toString",function(){return"[object Generator]"}),(e=function(){return{w:u,m:m}})()}function t(e,n,r,o){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}t=function(e,n,r,o){function a(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?i?i(e,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[n]=r:(a("next",0),a("throw",1),a("return",2))},t(e,n,r,o)}function n(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function r(e){return function(){var t=this,r=arguments;return new Promise(function(o,i){var a=e.apply(t,r);function u(e){n(a,o,i,u,c,"next",e)}function c(e){n(a,o,i,u,c,"throw",e)}u(void 0)})}}var o=null;function i(){return a.apply(this,arguments)}function a(){return a=r(e().m(function t(){var n,i,a,c;return e().w(function(t){for(;;)switch(t.p=t.n){case 0:if(o&&o.files&&0!==o.files.length){t.n=1;break}return console.error("Nessun file selezionato"),alert("Seleziona prima un file CSV"),t.a(2);case 1:return document.getElementById("run").disabled=!0,t.p=2,n=o.files[0],t.n=3,u(n);case 3:return i=t.v,a=s(i),t.n=4,Excel.run(function(){var t=r(e().m(function t(n){var r,o,i,u;return e().w(function(e){for(;;)switch(e.n){case 0:return r=n.workbook.worksheets.getActiveWorksheet(),(o=r.getUsedRange()).load("values"),e.n=1,n.sync();case 1:return i=o.values,i=l(a,i),(u=r.getRangeByIndexes(0,0,i.length,i[0].length)).values=i,e.n=2,p(i,r,n);case 2:return u.format.autofitColumns(),u.format.autofitRows(),e.n=3,n.sync();case 3:console.log("Importazione completata con successo!"),alert("Dati aggiornati con successo!");case 4:return e.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}());case 4:t.n=6;break;case 5:t.p=5,c=t.v,console.error("Errore:",c),alert("Errore durante l'importazione: "+c.message);case 6:return t.p=6,document.getElementById("loading").style.display="none",document.getElementById("run").disabled=!1,t.f(6);case 7:return t.a(2)}},t,null,[[2,5,6,7]])})),a.apply(this,arguments)}function u(e){return new Promise(function(t,n){var r=new FileReader;r.onload=function(){return t(r.result)},r.onerror=n,r.readAsArrayBuffer(e)})}function c(e){if(!e||0===e.length)return[];for(var t=-1,n=0;n<e[0].length;n++)if("matricola"===String(e[0][n]).toLowerCase()){t=n;break}if(-1===t)for(var r=0;r<e[0].length;r++){for(var o=new Set,i=!0,a=1;a<e.length;a++){if(o.has(e[a][r])){i=!1;break}o.add(e[a][r])}if(i){t=r;break}}return-1===t?[]:t}function s(e){return(new TextDecoder).decode(e).trim().split(/\r?\n/).map(function(e){var t=function(e){return e.replace(/"(\d+),(\d+)"/g,"$1.$2")}(e),n=t.includes(";")?";":",";return t.split(n).map(f)})}function f(e){if(e=e.trim(),/^\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}$/.test(e))return e;var t=e.toString(),n=Number(t);return isNaN(n)?t:n}function l(e,t){for(var n=c(e),r=c(t),o=e.slice(1).map(function(e){return e[n]}),i=t.slice(1).map(function(e){return e[r]}),a=0;a<o.length;a++){var u=i.indexOf(o[a]);if(-1!==u)for(var s=u+1,f=0;f<t[0].length;f++){var l=e[a+1][f],p=t[0][f];(p.toLowerCase().includes("mese")||p.toLowerCase().includes("data"))&&(t[s][f]=l),f!==r&&("number"==typeof l&&"number"==typeof t[s][f]?t[s][f]+=l:t[s][f]!=l&&(t[s][f]=l))}}return t}function p(e,t,n){return d.apply(this,arguments)}function d(){return(d=r(e().m(function t(n,r,o){var i,a,u,c,s;return e().w(function(e){for(;;)switch(e.n){case 0:for(i=0;i<n[0].length;i++){for(n[0][i].toString().toLowerCase(),a=!1,u=1;u<n.length;u++)"number"!=typeof(c=n[u][i])||Number.isInteger(c)||(a=!0);s=r.getRangeByIndexes(1,i,n.length-1,1),a&&(s.numberFormat=[["#,##0.00;[Red]-#,##0.00"]])}return e.n=1,o.sync();case 1:return e.a(2)}},t)}))).apply(this,arguments)}Office.onReady(function(e){if(e.host===Office.HostType.Excel){document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",o=document.getElementById("fileInput");var t=document.getElementById("run");o.addEventListener("change",function(){o.files&&o.files.length>0&&(console.log("File selezionato:",o.files[0].name),document.getElementById("fileName").textContent="Selected file: "+o.files[0].name)}),t.addEventListener("click",i)}})}(),function(){"use strict";new URL(n(58394),n.b),new URL(n(60947),n.b)}()}();
//# sourceMappingURL=taskpane.js.map