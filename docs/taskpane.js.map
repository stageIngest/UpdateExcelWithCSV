{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/* global alert, console, document, Excel, FileReader, Office, TextDecoder */\n\n\n\nlet fileInput = null;\nlet ColumnKeyName = \"\";\n\nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Excel) {\n\n    document.getElementById(\"sideload-msg\").style.display = \"none\";\n    document.getElementById(\"app-body\").style.display = \"flex\";\n\n    fileInput = document.getElementById(\"fileInput\");\n    const run = document.getElementById(\"run\");\n\n    fileInput.addEventListener(\"change\", () => {\n      if (fileInput.files && fileInput.files.length > 0) {\n        console.log(\"File selezionato:\", fileInput.files[0].name);\n        document.getElementById(\"fileName\").textContent =\n          \"Selected file: \" + fileInput.files[0].name;\n      }\n    });\n\n    run.addEventListener(\"click\", UpgradeExcel);\n  }\n});\n\n//it's the main function of the program\nasync function UpgradeExcel() {\n  if (!fileInput || !fileInput.files || fileInput.files.length === 0) {\n    console.error(\"Nessun file selezionato\");\n    alert(\"Seleziona prima un file CSV\");\n    return;\n  }\n\n  // disabilita run durante l'esecuzione\n  document.getElementById(\"run\").disabled = true;\n\n  try {\n    const CSVFile = fileInput.files[0];\n    const ReaderResult = await ReadFile(CSVFile);\n    const FormattedCSV = processCSV(ReaderResult);\n\n    await Excel.run(async (context) => {\n      let currWorksheet = context.workbook.worksheets.getActiveWorksheet();\n      const range = currWorksheet.getUsedRange();\n      range.load(\"values\");\n      await context.sync();\n\n      let ExcelData = range.values;\n      ExcelData = findInExcel(FormattedCSV, ExcelData);\n\n      let writingRange = currWorksheet.getRangeByIndexes(0, 0, ExcelData.length, ExcelData[0].length);\n      writingRange.values = ExcelData;\n\n      await formatColumns(ExcelData, currWorksheet, context, FormattedCSV);\n\n      writingRange.format.autofitColumns();\n      writingRange.format.autofitRows();\n\n      await context.sync();\n\n      console.log(\"Importazione completata con successo!\");\n      alert(\"Dati aggiornati con successo!\");\n    });\n  } catch (error) {\n    console.error(\"Errore:\", error);\n    alert(\"Errore durante l'importazione: \" + error.message);\n  } finally {\n    // Hide loading\n    document.getElementById(\"loading\").style.display = \"none\";\n    document.getElementById(\"run\").disabled = false;\n  }\n}\n\n//read from file csv and return an arraybuffer with its content\nfunction ReadFile(file) {\n  return new Promise((resolve, reject) => {\n    const Reader = new FileReader();\n    Reader.onload = () => resolve(Reader.result);\n    Reader.onerror = reject;\n    Reader.readAsArrayBuffer(file);\n  });\n}\n\n//return an array with the first column's data, this because the unique values are often in the first column\nfunction TakeKeyColumn(currValue) {\n  if (!currValue || currValue.length === 0) return [];\n\n  let keyColumnIndex = -1;\n\n  for (let c = 0; c < currValue[0].length; c++) {\n    if (String(currValue[0][c]).toLowerCase() === \"matricola\") {\n      keyColumnIndex = c;\n      break;\n    }\n  }\n\n  if (keyColumnIndex === -1) {\n    for (let c = 0; c < currValue[0].length; c++) {\n      let seen = new Set();\n      let unique = true;\n\n      for (let r = 1; r < currValue.length; r++) {\n        if (seen.has(currValue[r][c])) {\n          unique = false;\n          break;\n        }\n        seen.add(currValue[r][c]);\n      }\n\n      if (unique) {\n        keyColumnIndex = c;\n        break;\n      }\n    }\n  }\n\n  if (keyColumnIndex === -1) return [];\n\n  return keyColumnIndex;\n}\n\n\n\n//split the CSV, it works with , and ; in order to create a matrix 2D\nfunction processCSV(ReaderResult) {\n  let resultText = new TextDecoder().decode(ReaderResult).trim();\n\n  return resultText.split(/\\r?\\n/).map((rows) => {\n    let row = formatForSplitting(rows);\n    let separator = row.includes(\";\") ? \";\" : \",\";\n    return row.split(separator).map(cellFormat);\n  });\n}\n\n//changes the format of decimals found in the row necessary to have a correct splitting \nfunction formatForSplitting(rows) {\n  return rows.replace(/\"(\\d+),(\\d+)\"/g, \"$1.$2\");\n}\n\n//sets the cell format date, number or string\nfunction cellFormat(cell) {\n  cell = cell.trim();\n\n  // control for the date, it can handle separator / and - and different setting for numbers \n  if (/^\\d{1,2}[\\/\\-]\\d{1,2}[\\/\\-]\\d{2,4}$/.test(cell)) {\n    return cell; // is mantained as a string\n  }\n\n  let str = cell.toString();\n  let num = Number(str);\n  return isNaN(num) ? str : num;\n}\n\n// search the content of CSV first column into the first column of file excel and write in it\n// decimals are summed and strings are overwritten by the one in cvs\nfunction findInExcel(FormattedCSV, ExcelData) {\n  let keyindexCSV = TakeKeyColumn(FormattedCSV);\n  let keyindexExcel = TakeKeyColumn(ExcelData);\n\n  let keyColumnCSV = FormattedCSV.slice(1).map(row => row[keyindexCSV]);\n  let keyColumnExcel = ExcelData.slice(1).map(row => row[keyindexExcel]);\n\n  for (let csv = 0; csv < keyColumnCSV.length; csv++) {\n    let excelRowIndex = keyColumnExcel.indexOf(keyColumnCSV[csv]);\n\n    if (excelRowIndex !== -1) {\n      let indexRow = excelRowIndex + 1;\n\n      for (let col = 0; col < ExcelData[0].length; col++) {\n        let csvValue = FormattedCSV[csv + 1][col];\n        let columnName = ExcelData[0][col];\n        if (columnName.toLowerCase().includes(\"mese\") || (columnName.toLowerCase().includes(\"data\"))) {\n          ExcelData[indexRow][col] = csvValue;\n        }\n        if (col === keyindexExcel) continue;\n\n        if (typeof csvValue === 'number' && typeof ExcelData[indexRow][col] === 'number') {\n          ExcelData[indexRow][col] += csvValue;\n        } else if (ExcelData[indexRow][col] != csvValue) {\n          ExcelData[indexRow][col] = csvValue;\n        }\n      }\n    }\n  }\n  return ExcelData;\n}\n\n\n//set format of the column for numbers with . for the thousands and , for the decimal part, negative number are -#### and written in red, with separators as explained before\nasync function formatColumns(ExcelData, worksheet, context, FormattedCSV) {\n  for (let c = 0; c < ExcelData[0].length; c++) {\n    let columnName = ExcelData[0][c].toString().toLowerCase();\n\n    let hasDate = false;\n    let hasDecimal = false;\n\n    for (let r = 1; r < ExcelData.length; r++) {\n      let cellValue = ExcelData[r][c];\n\n      //decimal check\n      if (typeof cellValue === 'number' && !Number.isInteger(cellValue)) {\n        hasDecimal = true;\n      }\n      else if (typeof cellValue === 'string' && /^\\d{1,2}[\\/\\-]\\d{1,2}[\\/\\-]\\d{2,4}$/.test(cellValue)) {\n        hasDate = true;\n        break;\n      }\n\n    }\n    \n    let column = worksheet.getRangeByIndexes(1, c, ExcelData.length - 1, 1);\n\n    if (hasDecimal) {\n      column.numberFormat = [[\"#,##0.00;[Red]-#,##0.00\"]];\n    }\n    else if (hasDate) {\n      for (let rowNo = 1; row < ExcelData.length; rowNo ++) {\n        ExcelData[rowNo][c] = FormattedCSV[rowNo][c];\n        ExcelData[rowNo][c].numberFormat = [[\"@\"]];\n      }  \n    }\n    \n  }\n  await context.sync();\n}\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_1___ = new URL(\"./taskpane.js\", import.meta.url);\n// Module\nvar code = \" <!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>UPDATE EXCEL CON CSV</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> <\" + \"script src=\\\"\" + ___HTML_LOADER_IMPORT_1___ + \"\\\"><\" + \"/script> </head> <body class=\\\"ms-font-m ms-welcome ms-Fabric\\\"> <header class=\\\"ms-welcome__header ms-bgColor-neutralLighter\\\"> <img width=\\\"170\\\" height=\\\"90\\\" src=\\\"https://stageingest.github.io/UpdateExcelWithCSV/assets/logoIngest.png\\\" alt=\\\"Ingest\\\" title=\\\"Ing.UpdateExcelWithCsv\\\"/> <h1 class=\\\"ms-font-su\\\">Welcome</h1> <input type=\\\"file\\\" id=\\\"fileInput\\\" accept=\\\".csv\\\" style=\\\"display:none\\\" multiple=\\\"multiple\\\"/> <label for=\\\"fileInput\\\" id=\\\"browse\\\" class=\\\"ms-Button ms-Button--hero ms-font-xl\\\" style=\\\"border:2px solid #0078d4;padding:10px 20px;cursor:pointer\\\"> <span class=\\\"ms-Button-label\\\">Seleziona CSV</span> </label> <p id=\\\"fileName\\\"></p> <button id=\\\"run\\\" type=\\\"button\\\" class=\\\"ms-welcome__action ms-Button ms-Button--hero ms-font-l\\\" style=\\\"border:2px solid #0078d4;padding:8px 16px\\\"> <span class=\\\"ms-Button-label\\\">Update Excel con Csv</span> </button> </header> <section id=\\\"sideload-msg\\\" class=\\\"ms-welcome__main\\\"> <h2 class=\\\"ms-font-xl\\\">Please <a target=\\\"_blank\\\" href=\\\"https://learn.microsoft.com/office/dev/add-ins/testing/test-debug-office-add-ins#sideload-an-office-add-in-for-testing\\\">sideload</a> your add-in to see app body.</h2> </section> <main id=\\\"app-body\\\" class=\\\"ms-welcome__main\\\" style=\\\"display:none\\\"> <h2 class=\\\"ms-font-xl\\\"> Aggiorna i dati di un file excel esistente con quelli contenuti in un file Csv </h2> <ul class=\\\"ms-List ms-welcome__features\\\"> <li class=\\\"ms-ListItem\\\"> <span class=\\\"ms-font-m\\\">1. Apri il file Excel da aggiornare</span> </li> <li class=\\\"ms-ListItem\\\"> <span class=\\\"ms-font-m\\\">2. Seleziona l'add-in UpdateExcelFromCsv</span> </li> <li class=\\\"ms-ListItem\\\"> <span class=\\\"ms-font-m\\\">3. Premi Importa Csv</span> </li> <li class=\\\"ms-ListItem\\\"> <span class=\\\"ms-font-m\\\">4. Seleziona il file Csv che vuoi utilizzare e conferma</span> </li> <li class=\\\"ms-ListItem\\\"> <span class=\\\"ms-font-m\\\">5. Premi Update</span> </li> </ul> <p class=\\\"ms-font-l\\\"> Quando Ã¨ tutto pronto, premi <b>Update</b>.</p> <div id=\\\"loading\\\" style=\\\"display:none\\\">Processing...</div> <button class=\\\"run-button ms-welcome__action ms-Button ms-Button--hero ms-font-xl\\\" type=\\\"button\\\" style=\\\"border:2px solid #0078d4;padding:8px 16px\\\"> <span class=\\\"ms-Button-label\\\">Update Excel con Csv</span> </button> <p><label id=\\\"item-subject\\\"></label></p> </main> </body> </html>\";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","d","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","fileInput","UpgradeExcel","_UpgradeExcel","_callee2","CSVFile","ReaderResult","FormattedCSV","_t","_context2","files","console","error","alert","getElementById","disabled","ReadFile","processCSV","Excel","run","_ref","_callee","context","currWorksheet","range","ExcelData","writingRange","_context","workbook","worksheets","getActiveWorksheet","getUsedRange","load","sync","values","findInExcel","getRangeByIndexes","formatColumns","format","autofitColumns","autofitRows","log","_x5","message","style","display","file","reject","Reader","FileReader","onload","result","onerror","readAsArrayBuffer","TakeKeyColumn","currValue","keyColumnIndex","String","toLowerCase","seen","Set","unique","has","add","TextDecoder","decode","trim","split","map","rows","row","formatForSplitting","separator","includes","cellFormat","cell","str","toString","num","Number","isNaN","keyindexCSV","keyindexExcel","keyColumnCSV","slice","keyColumnExcel","csv","excelRowIndex","indexOf","indexRow","col","csvValue","columnName","_x","_x2","_x3","_x4","_formatColumns","_callee3","worksheet","hasDate","hasDecimal","cellValue","column","rowNo","_context3","isInteger","numberFormat","Office","onReady","info","host","HostType","addEventListener","name","textContent","URL"],"ignoreList":[],"sourceRoot":""}